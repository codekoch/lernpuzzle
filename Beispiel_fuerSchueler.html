<!DOCTYPE html><html lang="de"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Puzzle - Elektrische GrÃ¶ÃŸen - Bring Ordnung in das Chaos! </title>
<style>
        /* --- GRUNDLAYOUT & iOS FIXES --- */
        html {
            height: 100%;
            -webkit-text-size-adjust: 100%; 
            touch-action: manipulation;
        }
        body {
            height: 100dvh;
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background-color: #f4f7f6;
            overflow: hidden;
        }

        /* --- SCROLLBARS --- */
        ::-webkit-scrollbar { width: 4px; height: 4px; }
        ::-webkit-scrollbar-thumb { background: #ccc; border-radius: 2px; }
        ::-webkit-scrollbar-track { background: transparent; }

        /* --- EDITOR --- */
        #input-section {
            background-color: white;
            padding: 20px;
            box-sizing: border-box;
            width: 100%;
            max-width: 800px;
            margin: 20px auto;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            max-height: 95dvh;
            overflow-y: auto;
            display: flex; flex-direction: column;
        }

        h2 { color: #333; margin: 0 0 15px 0; text-align: center; flex-shrink: 0; }
        
        .input-title-row { display: flex; align-items: center; gap: 10px; margin-bottom: 20px; flex-shrink: 0; }
        .input-title-row label { font-weight: bold; font-size: 1.1em; flex-shrink: 0; }
        #game-title-wrapper { position: relative; height: 48px; flex-grow: 1; }
        #game-title-wrapper input, #game-title-wrapper .preview-cell { position: absolute; top: 0; left: 0; width: 100%; height: 100%; padding: 10px; font-size: 1.1em; border: 1px solid #ced4da; border-radius: 4px; box-sizing: border-box; }
        #game-title-wrapper .preview-cell { display: none; align-items: center; text-align: left; background-color: #f8f9fa; cursor: pointer; font-weight: bold; }

        #dimension-setter { display: flex; justify-content: center; align-items: center; gap: 15px; margin-bottom: 15px; flex-shrink: 0; }
        #dimension-setter label { font-weight: bold; }
        #dimension-setter input[type="number"] { width: 60px; padding: 8px; font-size: 1em; }
        #generate-grid-button { padding: 8px 15px; font-size: 1em; background-color: #555; color: white; border: none; border-radius: 5px; cursor: pointer; }
        
        /* HILFE-BEREICH (Wieder da!) */
        #help-text-wrapper { margin-bottom: 15px; flex-shrink: 0; }
        #help-text-wrapper label { display: block; font-weight: bold; margin-bottom: 5px; }
        #help-text-input { width: 100%; height: 80px; padding: 8px; border: 1px solid #ced4da; border-radius: 4px; box-sizing: border-box; font-family: inherit; resize: vertical; }

        #order-switch-wrapper { margin-top: 10px; padding-top: 10px; border-top: 1px solid #eee; text-align: center; flex-shrink: 0; }
        #order-switch-wrapper label { font-weight: bold; font-size: 1em; cursor: pointer; margin-left: 5px; }
        #force-order-switch { width: 16px; height: 16px; vertical-align: middle; cursor: pointer; }

        #input-grid { display: grid; gap: 10px; margin-bottom: 20px; margin-top: 10px; flex-grow: 1; }
        .input-header-label, .input-row-label { grid-column: 1 / -1; font-weight: bold; margin-top: 15px; text-align: left; color: #343a40; }
        
        .input-cell-wrapper { position: relative; width: 100%; min-height: 60px; height: auto; }
        #input-grid input[type="text"] { width: 100%; min-height: 60px; padding: 10px; border: 1px solid #ced4da; border-radius: 4px; box-sizing: border-box; font-size: 1em; }
        
        .preview-cell { 
            width: 100%; min-height: 60px; height: auto; padding: 10px; 
            border: 1px solid #ced4da; border-radius: 4px; box-sizing: border-box; 
            font-size: 1.1em; display: flex; justify-content: center; align-items: center; 
            background-color: #f8f9fa; cursor: pointer; overflow: hidden; text-align: center; 
            word-break: normal; overflow-wrap: break-word; hyphens: auto;
        }
        .preview-cell img, .preview-cell svg { width: 100%; height: 100%; object-fit: contain; pointer-events: none; }
        .preview-cell svg { width: 100%; height: 100%; object-fit: contain; }
        #input-grid .preview-cell { font-size: 1em; font-weight: bold; }

        #start-button { padding: 12px 25px; font-size: 17px; cursor: pointer; background-color: #28a745; color: white; border: none; border-radius: 5px; transition: background-color 0.3s; margin-top: 15px; display: block; width: 100%; flex-shrink: 0; }
        
        #template-controls { display: flex; gap: 10px; justify-content: center; margin-top: 20px; border-top: 1px solid #eee; padding-top: 20px; flex-shrink: 0; flex-wrap: wrap; }
        #template-controls button { padding: 10px 15px; font-size: 1em; font-weight: bold; border: none; border-radius: 5px; cursor: pointer; }
        #save-template-button { background-color: #007bff; color: white; }
        #load-template-button { background-color: #28a745; color: white; }
        #load-template-input { display: none; }

        /* --- SPIEL-BEREICH --- */
        #game-section { 
            display: none; flex-direction: column; 
            height: 100dvh; width: 100%; 
            padding: 10px 10px 50px 10px; box-sizing: border-box; 
        }
        
        #game-title-display { word-break: break-word; font-size: 1.5em; margin: 5px 0; text-align: center; flex-shrink: 0; }
        #score-display { font-size: 1em; font-weight: bold; color: #333; margin: 5px 0 10px 0; text-align: center; flex-shrink: 0; }
        
        #controls { margin-bottom: 10px; display: flex; flex-wrap: wrap; justify-content: center; gap: 8px; flex-shrink: 0; align-items: center; }
        #shuffle-button, #reset-button, #download-button, #download-editable-button, #help-button { 
            padding: 8px 12px; font-size: 0.9em; cursor: pointer; color: white; border: none; border-radius: 5px; transition: background-color 0.3s; 
        }
        #shuffle-button { background-color: #007bff; }
        #reset-button { background-color: #6c757d; }
        #download-button { background-color: #17a2b8; }
        #download-editable-button { background-color: #ffc107; color: #212529; }
        #help-button { background-color: #17a2b8; font-weight: bold; }

        #table-header { display: grid; gap: 4px; width: 100%; margin-bottom: 4px; flex-shrink: 0; }
        .header-cell { 
            background-color: #e9ecef; border: 1px solid #ced4da; border-radius: 4px; 
            text-align: center; font-weight: bold; padding: 4px; 
            display: flex; align-items: center; justify-content: center; 
            word-break: normal; overflow-wrap: break-word; hyphens: auto; min-height: 30px; height: auto;
            font-size: 1em; 
        }
        
        #game-board { display: grid; gap: 4px; width: 100%; flex-grow: 1; min-height: 0; }
        
        .grid-item { 
            background-color: #ffffff; border: 1px solid #ced4da; border-radius: 4px; 
            display: flex; justify-content: center; align-items: center; 
            font-weight: bold; cursor: move; 
            user-select: none; transition: all 0.1s ease; text-align: center; padding: 4px; 
            width: 100%; height: 100%; overflow-y: auto; 
            word-break: normal; overflow-wrap: break-word; hyphens: auto; box-sizing: border-box;
            font-size: 1em; 
        }
        .grid-item.dragging { opacity: 0.6; border: 2px dashed #007bff; }
        .grid-item.correct { border: 2px solid #28a745; background-color: #eafaea; cursor: not-allowed; }
        .grid-item img, .grid-item svg { width: 100%; height: 100%; object-fit: contain; padding: 2px; box-sizing: border-box; pointer-events: none; }
        .grid-item svg { width: 100%; height: 100%; object-fit: contain; padding: 5px; box-sizing: border-box; }

        /* --- MODAL STYLES --- */
        .modal {
            display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; 
            overflow: auto; background-color: rgba(0,0,0,0.5); backdrop-filter: blur(2px);
        }
        .modal-content {
            background-color: #fefefe; margin: 10% auto; padding: 20px; border: 1px solid #888;
            width: 90%; max-width: 600px; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.2); position: relative;
        }
        .close-button { color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer; line-height: 20px; }
        .close-button:hover, .close-button:focus { color: black; text-decoration: none; cursor: pointer; }
        #modal-text { font-size: 1.1em; line-height: 1.5; color: #333; margin-top: 10px; white-space: pre-wrap; }
    </style></head>
<body>
<h2>Puzzle - Elektrische GrÃ¶ÃŸen - Bring Ordnung in das Chaos! </h2>
<div id="game-section" style="display:flex; flex-direction:column; height:100dvh; width:100%; padding:10px 10px 50px 10px; box-sizing:border-box;">
<p id="score-display" style="font-size: 1.1em; font-weight: bold; color: #333; margin: 5px 0 10px 0; text-align: center; flex-shrink: 0;">Korrekte Zeilen: 0 / 8</p>
<div id="controls" style="margin-bottom: 10px; display: flex; flex-wrap: wrap; justify-content: center; gap: 8px; flex-shrink: 0; align-items: center;">
<button id="shuffle-button" style="padding: 8px 12px; font-size: 0.9em; cursor: pointer; color: white; border: none; border-radius: 5px; background-color: #007bff;">Erneut mischen</button>
<button id="help-button" style="padding: 8px 12px; font-size: 0.9em; cursor: pointer; color: white; border: none; border-radius: 5px; background-color: #17a2b8; font-weight: bold; ">Hilfe</button>
</div>
<div id="table-header" style="display:grid; gap:4px; width:100%; margin-bottom:4px; flex-shrink:0; grid-template-columns: repeat(5, 1fr);"><div class="header-cell">Physikalische GrÃ¶ÃŸe</div>
<div class="header-cell">Formelsymbol</div>
<div class="header-cell">Einheit</div>
<div class="header-cell">Einheitensymbol</div>
<div class="header-cell">Zusammenhang</div></div>
<div id="game-board" style="display:grid; gap:4px; width:100%; flex-grow:1; min-height:0; grid-template-columns: repeat(5, 1fr); grid-template-rows: repeat(8, minmax(0, 1fr));"></div>
</div>
<div id="help-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">Ã—</span>
            <h3 style="margin-top: 0;">Spielregeln / Hilfe</h3>
            <div id="modal-text">Ordne per Drag and Drop die Kacheln der richtigen Ãœberschrift zu und achte darauf, dass in einer Zeile alles zueinander passt.</div>
        </div>
    </div>
<script>
document.addEventListener('DOMContentLoaded', () => {
const gameBoard = document.getElementById('game-board'); const shuffleButton = document.getElementById('shuffle-button');
const scoreDisplay = document.getElementById('score-display');
const helpButton = document.getElementById('help-button'); const helpModal = document.getElementById('help-modal');
const modalText = document.getElementById('modal-text'); const closeButton = document.querySelector('.close-button');
const solution = [["Spannung","U","Volt","V","U=Râ‹…I"],["Strom","I","Ampere","A","I=U/R"],["Widerstand","R","Ohm","Î©","R=U/I"],["Ladung","Q","Coulomb","C","Q=Iâ‹…t"],["elektrische Kraft","F<sub>el</sub>","Newton","N","F<sub>el</sub>=Eâ‹…Q"],["elektrisches Feld","E","Volt pro Meter","V/m","E=F<sub>el</sub>/Q"],["elektrische Energie","E<sub>el</sub>","Joule oder Elektronenvolt","J oder eV","E<sub>el</sub>=Qâ‹…U"],["elektrische Leistung","P","Watt","W","P=Uâ‹…I"]];
const isOrderForced = false;
const helpText = "Ordne per Drag and Drop die Kacheln der richtigen Ãœberschrift zu und achte darauf, dass in einer Zeile alles zueinander passt.";
let draggedItem = null; let startTime = null; let endTime = null;

modalText.innerHTML = helpText.replace(/\n/g, '<br>');
function openModal() { helpModal.style.display = "block"; }
function closeModal() { helpModal.style.display = "none"; }
if(helpButton) helpButton.addEventListener('click', openModal);
if(closeButton) closeButton.addEventListener('click', closeModal);
window.addEventListener('click', (event) => { if (event.target == helpModal) closeModal(); });

function renderCellContent(cell, content) { content = content || ''; if (content.match(/\.(jpeg|jpg|gif|png|webp)$/i) && (content.startsWith('http://') || content.startsWith('https://'))) { cell.innerHTML = `<img src="${content}" alt="Bild-Kachel">`; } else { cell.innerHTML = content; } }
function areArraysEqual(arr1, arr2) { if (arr1.length !== arr2.length) { return false; } for (let i = 0; i < arr1.length; i++) { if (arr1[i] !== arr2[i]) { return false; } } return true; }
function formatDateTime(date) { return date.toLocaleString('de-DE'); }
function formatDuration(ms) { const totalSeconds = Math.floor(ms/1000); const minutes = Math.floor(totalSeconds/60); const seconds = totalSeconds % 60; return `${minutes} Min. ${seconds} Sek.`; }
function fitTextToTiles() {
                const elements = document.querySelectorAll('.grid-item, .header-cell');
                elements.forEach(el => {
                    if (el.querySelector('img') || el.querySelector('svg')) return;
                    let fontSize = 18; 
                    const minFontSize = 9;
                    el.style.fontSize = fontSize + 'px';
                    while ( (el.scrollHeight > el.clientHeight || el.scrollWidth > el.clientWidth) && fontSize > minFontSize ) {
                        fontSize -= 0.5;
                        el.style.fontSize = fontSize + 'px';
                    }
                });
            }
window.addEventListener('resize', fitTextToTiles);
function initGame() { gameBoard.innerHTML = ''; const correctItems = solution.flat(); correctItems.forEach((itemText, index) => { const item = document.createElement('div'); item.classList.add('grid-item'); item.setAttribute('draggable', true); item.id = `item-${index}`; renderCellContent(item, itemText); item.dataset.value = itemText; item.addEventListener('dragstart', handleDragStart); item.addEventListener('dragover', handleDragOver); item.addEventListener('drop', handleDrop); item.addEventListener('dragend', handleDragEnd); gameBoard.appendChild(item); }); shuffleItems(); }
function shuffleItems() { let items = Array.from(gameBoard.children); let contents = solution.flat(); for (let i = contents.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [contents[i], contents[j]] = [contents[j], contents[i]]; } items.forEach((item, index) => { renderCellContent(item, contents[index]); item.dataset.value = contents[index]; item.classList.remove('correct'); item.setAttribute('draggable', true); item.style.fontSize = ''; }); startTime = new Date(); checkSolution(); setTimeout(fitTextToTiles, 50); }
function checkSolution() {
    if (solution.length === 0 || !solution[0]) return;
    let allRowsAreCorrect = true; let correctRowCount = 0;
    const items = Array.from(gameBoard.children); const numColsOnBoard = solution[0].length; const numRowsOnBoard = solution.length;
    let boardRows = [];
    for (let r = 0; r < numRowsOnBoard; r++) {
        let currentRowContents = []; let currentRowItems = [];
        for (let c = 0; c < numColsOnBoard; c++) {
            const itemIndex = r * numColsOnBoard + c; if (!items[itemIndex]) continue;
            const currentItem = items[itemIndex]; currentRowItems.push(currentItem); currentRowContents.push(currentItem.dataset.value);
        }
        boardRows.push({ items: currentRowItems, contents: currentRowContents });
    }
    if (false) {
        for (let r = 0; r < numRowsOnBoard; r++) {
            const boardRow = boardRows[r];
            if (areArraysEqual(boardRow.contents, solution[r])) {
                boardRow.items.forEach(item => { item.classList.add('correct'); item.setAttribute('draggable', false); }); correctRowCount++;
            } else {
                boardRow.items.forEach(item => { item.classList.remove('correct'); item.setAttribute('draggable', true); }); allRowsAreCorrect = false;
            }
        }
    } else {
        let availableSolutions = JSON.parse(JSON.stringify(solution));
        for (let boardRow of boardRows) {
            let isCorrect = false; let matchedIndex = -1;
            for (let i = 0; i < availableSolutions.length; i++) {
                if (areArraysEqual(boardRow.contents, availableSolutions[i])) { isCorrect = true; matchedIndex = i; break; }
            }
            if (isCorrect) {
                boardRow.items.forEach(item => { item.classList.add('correct'); item.setAttribute('draggable', false); });
                availableSolutions.splice(matchedIndex, 1); correctRowCount++;
            } else {
                boardRow.items.forEach(item => { item.classList.remove('correct'); item.setAttribute('draggable', true); }); allRowsAreCorrect = false;
            }
        }
    }
    scoreDisplay.textContent = `Korrekte Zeilen: ${correctRowCount} / ${numRowsOnBoard}`;
    if (allRowsAreCorrect && numRowsOnBoard > 0) {
        endTime = new Date();
        const durationMs = endTime - startTime;
        const msg = `ðŸŽ‰ Super! Du hast alle Zeilen richtig zugeordnet!\n\nStart: ${formatDateTime(startTime)}\nEnde: ${formatDateTime(endTime)}\nDauer: ${formatDuration(durationMs)}`;
        setTimeout(() => { alert(msg); }, 100);
    }
}
function handleDragStart(e) { if (this.classList.contains('correct')) { e.preventDefault(); return; } draggedItem = this; e.dataTransfer.effectAllowed = 'move'; e.dataTransfer.setData('text/plain', ''); e.dataTransfer.setData('text/html', this.innerHTML); setTimeout(() => this.classList.add('dragging'), 0); }
function handleDragOver(e) { e.preventDefault(); return false; }
function handleDrop(e) { e.stopPropagation(); const targetItem = this; if (draggedItem === targetItem || targetItem.classList.contains('correct')) { return; } const draggedContent = draggedItem.innerHTML; const draggedValue = draggedItem.dataset.value; const targetContent = targetItem.innerHTML; const targetValue = targetItem.dataset.value; draggedItem.innerHTML = targetContent; draggedItem.dataset.value = targetValue; targetItem.innerHTML = draggedContent; targetItem.dataset.value = draggedValue; const draggedSize = draggedItem.style.fontSize; draggedItem.style.fontSize = targetItem.style.fontSize; targetItem.style.fontSize = draggedSize; checkSolution(); }
function handleDragEnd() { this.classList.remove('dragging'); draggedItem = null; }
shuffleButton.addEventListener('click', shuffleItems); initGame();
});
</script></body></html>